{"version":3,"sources":["../../src/components/searchBox.js"],"names":["SearchBox","props","displayName","state","searchBox","internalPosition","postRender","bind","ref","boundsListener","placesListener","timer","map","maps","position","input","findDOMNode","container","child","places","remove","addListener","clearTimeout","setTimeout","map_bounds","getBounds","setBounds","onPlacesChanged","query","value","service","PlacesService","textSearch","bounds","status","PlacesServiceStatus","OK","getPlaces","controls","ControlPosition","push","insertAt","length","setState","console","warn","Error","name","item","nextProps","nextState","prevProps","prevState","removeAt","Wrapper","wrapper","placeholder","style","className","Component","propTypes","string","isRequired","func"],"mappings":"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","file":"searchBox.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport ReactDom from 'react-dom';\n\nclass SearchBox extends React.Component {\n    constructor(props) {\n        super(props);\n        this.displayName = 'SearchBox';\n        this.state = {\n        \tsearchBox : null,\n        \tinternalPosition : -1\n        }\n        this.postRender = this.postRender.bind(this);\n        this.ref = this.ref.bind(this);\n        this.boundsListener = null;\n        this.placesListener = null;\n        this.timer = null;\n    }\n    componentDidMount() {\n   \t this.postRender();\n    }\n    postRender() {\n    \tvar {map, maps, position} = this.props;\n    \tif(map && maps) {\n\t    \tvar input = ReactDom.findDOMNode(this.input);\n\t    \tvar container = ReactDom.findDOMNode(this.child);\n\t    \tvar searchBox = new maps.places.SearchBox(input);\n\n            this.timer = null;\n\n            if(this.boundsListener)\n                this.boundsListener.remove();\n            if(this.placesListener)\n                this.placesListener.remove();\n\n\t    \tthis.boundsListener = map.addListener('bounds_changed', () => {\n                if(this.timer) {\n                    clearTimeout(this.timer);\n                }\n                this.timer = setTimeout(() => {\n                    const map_bounds = map.getBounds();\n                    searchBox.setBounds(map_bounds);\n\n                    if(typeof this.props.onPlacesChanged === 'function' && this.input) {\n                        const query = this.input.value;\n                        const service = new maps.places.PlacesService(map);\n                        query ? service.textSearch({\n                            query,\n                            bounds: map_bounds\n                        }, (places, status) => {\n                            if(status == maps.places.PlacesServiceStatus.OK) {\n                                this.props.onPlacesChanged(places);\n                            }\n                        }) : '';\n                    }\n                }, 5000);\n\t\t    });\n\n\t\t\tthis.placesListener = searchBox.addListener('places_changed', () => {\n               if(typeof this.props.onPlacesChanged === 'function')\n\t               this.props.onPlacesChanged(searchBox.getPlaces());\n            });\n\n\t    \tif(!position)\n\t    \t\tposition = \"TOP_LEFT\";\n\n\t    if(this.state.internalPosition < 0)\n\t\t\t\tmap.controls[maps.ControlPosition[position]].push(container);\n\t\t\telse\n\t\t\t\tmap.controls[maps.ControlPosition[position]].insertAt(this.state.internalPosition, container);\n\n\t\t\tvar internalPosition = map.controls[maps.ControlPosition[position]].length-1;\n\n\t\t\tif(this.state.internalPosition != internalPosition)\n\t\t\t\tthis.setState({\n\t\t\t\t\tinternalPosition\n\t\t\t\t});\n    \t}\n    \telse\n    \t\tconsole.warn(new Error(\"You must pass this component as a control to a Map component.\"))\n    }\n    ref(name) {\n      return (item) => {\n        this[name] = item;\n      };\n    }\n    shouldComponentUpdate(nextProps, nextState) {\n    \treturn false;\n    }\n    componentDidUpdate(prevProps, prevState) {\n    \tif(this.state.internalPosition > -1 && prevState.internalPosition != -1)\n\t    \tthis.postRender();\n    }\n    componentWillUnmount() {\n      const { map, maps, position } = this.props;\n      if (this.state.internalPosition >= 0) {\n        map.controls[maps.ControlPosition[position || 'TOP_LEFT']]\n          .removeAt(this.state.internalPosition);\n      }\n    }\n    render() {\n    \tvar Wrapper = this.props.wrapper;\n    \tif(Wrapper)\n    \t\treturn <div ref={this.ref('parent')}><div ref={this.ref('child')}><Wrapper><input type=\"text\" ref={this.ref('input')} placeholder={this.props.placeholder} style={this.props.style} className={this.props.className} /></Wrapper></div></div>\n    \telse\n\t        return <div ref={this.ref('parent')}><div ref={this.ref('child')}><input type=\"text\" ref={this.ref('input')} placeholder={this.props.placeholder} style={this.props.style} className={this.props.className} /></div></div>;\n    }\n}\n\nSearchBox.propTypes = {\n  placeholder : PropTypes.string,\n\tposition : PropTypes.string.isRequired,\n\twrapper : PropTypes.func,\n\tonPlacesChanged : PropTypes.func.isRequired\n}\n\nexport default SearchBox;\n"]}